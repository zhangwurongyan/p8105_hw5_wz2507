---
title: "hw 5"
author: "Wurongyan Zhang"
date: "11/5/2019"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## problem 1

```{r}
library(tidyverse)
library(ggplot2)

set.seed(10)

iris_with_missing = iris %>% 
  map_df(~replace(.x, sample(1:150, 20), NA)) %>%
  mutate(Species = as.character(Species))
```

```{r,warning=FALSE}
summary(is.na(iris_with_missing)) %>% 
  knitr::kable()
```

As we can see from the summary above, the data set iris_with_missing has 20 missing values in each of the 5 variables.

```{r}
na_func = function(x){
  if(is.character(x)){
    x=replace_na(x,"virginica")
  }
  else if(is.numeric(x)){
    x=replace_na(x, round(mean(x,na.rm=TRUE),1))
  }
  x
}

iris=map_dfr(iris_with_missing,na_func)

summary(is.na(iris))%>% 
  knitr::kable()
```

As we can see from the second table, there are no missing values after the function.

## problem 2

```{r,message=FALSE}
file = list.files("data")

file_func=function(x){
  path=str_c("./data/",x)
  read_csv(path)
 }

file_data = purrr::map_dfr(file, file_func) %>% 
 janitor::clean_names() %>% 
  mutate(file_name=file) %>% 
  mutate(file_name=str_remove(file_name,".csv")) %>% 
  separate(file_name, into = c("arm","subject_id"),sep="_") %>% arrange(arm,subject_id) %>% 
  select(subject_id, arm, everything())
  
 
```

```{r}
file_data_week=file_data %>% 
  pivot_longer(week_1:week_8,
               names_to="weeks",
               values_to = "values") %>% 
  separate(weeks, into = c("week","weeks"),sep = "_")

file_data_week %>% 
  ggplot(aes(x=weeks, y=values, group=subject_id, color=subject_id))+
  geom_line()+facet_grid(~arm) +
  labs(title = "Observations on each subject over time")
  
```

#comments

## problem 3


























